{
  inputs,
  config,
  lib,
  pkgs,
  isServer,
  ...
}: let
  inherit (lib.modules) mkIf;
  cfg = config.bifrost.programs.pentest;
in {
  imports = [
    ./wireshark.nix
    ./wordlists.nix
  ];

  config = mkIf (!isServer && cfg.enable) {
    environment.systemPackages = with pkgs; [
      inputs.burpsuitepro.packages.x86_64-linux.default

      hashcat
      hashcat-utils
      hcxtools
      hcxdumptool

      netdiscover

      #enum
      python313Packages.shodan
      python313Packages.censys
      uncover
      whatweb

      subfinder
      amass
      nuclei
      nuclei-templates
      commix
      nmap
      naabu
      logkeys
      assetfinder
      gobuster
      sqlmap
      ghauri
      aircrack-ng
      proxychains-ng
      thc-hydra
      tcpdump
      # john
      evil-winrm
      nikto

      #xss
      gau
      uroboros
      dalfox

      bettercap

      holehe

      htb-toolkit
      libsecret

      zap

      metasploit
      katana
      httpx
      freerdp3
      ffuf

      #waf
      wafw00f
      waf-tester

      # ida-free
      # ghidra
    ];
  };
}
